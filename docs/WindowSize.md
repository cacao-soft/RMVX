# エセフルスクリーン

ゲームウィンドウのサイズを変更する機能を追加します。

## スクリーンショット

![スクショ１](imgs/SS091227970515.jpg)

※ 画像は開発中のものです。

## ダウンロード

- [スクリプトファイル](https://github.com/cacao-soft/RMVX/raw/main/WindowSize.rb)
- [旧バージョン v1.0.x](WindowSize10x.md)

## 設定項目

### サイズ変更キー

```rb
INPUT_KEY = Input::F5
```

`Input::F5` `Input::F6` `Input::F7` `Input::F8` などが設定できます。
サイズ変更を行わない場合は、`0`としてください。

### サイズリスト

```rb
SIZE_LIST = [[0, 0], [Graphics.width * 2, Graphics.height * 2], [-1, -1]]
```

変更できるサイズのリストです。変更キーが押されるたびに左から順番にサイズ変更が行われます。\
デフォルトでは、ゲーム解像度の`等倍 -> ２倍 -> デスクトップサイズ`の順に切り替えます。

`[横幅,縦幅]`がセットで、最初のサイズが初期サイズとなります。\
幅を`0`にするとゲーム解像度サイズ、`-1`にするとデスクトップサイズになります。

> [!WARNING]
>
> - 快適なプレイのためゲームの解像度と同じサイズは設定するようにしてください。
> - 変更後の画質は、環境に依存します。解像度の２倍サイズは、どの環境でも比較的きれいに表示されると思います。
> - 画面内に納まらない大きいサイズは除外されます。

### セーブファイル

```rb
FILE_SAVE = "wndsz"
```

指定されたファイル名で現在のサイズ情報を保存します。`nil`にすると、サイズを変更しません。

> [!WARNING]
> フォルダは作成されませんので、ファイル名のみの設定を推奨します。

### 構成設定ファイル

```rb
FILE_INI = nil
```

構成設定ファイルを使用して初期サイズを変更する場合は、[初期化ファイルの操作](https://raw.githubusercontent.com/cacao-soft/RMVX/main/ExFile.rb)スクリプトを導入し`Game.ini`ファイルに次の３行を追加します。

```ini
[Window]
WIDTH=800
HEIGHT=600
```

数値部分がウィンドウのサイズとなりますので、変更してください。

初期化ファイルで設定ができるので、プレイヤーの好きなサイズで遊べるかな？と思ってたりします。\
その際は、サイズ変更を無効にしないと設定したサイズに戻れなくなります。

## 拡張機能

### 位置情報も変更

`WLIB::SetGameWindowSize`を使用すると、ウィンドウの位置は自動で中央に変更されます。位置も含めて指定したい場合は、
`WLIB::SetWindowPos(hwnd, x, y, width, height, z, flag)`を使用してください。

`WLIB::SetGameWindowSize`は、クライアント領域での設定ですが、
`WLIB::SetWindowPos`は、ウィンドウのサイズで設定する必要があります。
現在のウィンドウのサイズを取得するには、`WLIB::GetGameWindowRect`を使用します。
ちなみに、クライアント領域は、`WLIB::GetGameClientRect`です。
こちらは、サイズのみの取得ですので、プロパティ x と y は、常に 0 となります。

```ruby
hwnd = WLIB::GAME_HANDLE
r = WLIB::GetGameWindowRect()
WLIB::SetWindowPos(hwnd, r.x, r.y, r.width, r.height, 0, WLIB::SWP_NOZORDER)
```

`WLIB::SetWindowPos`は、Win32API の関数ほぼそのままですので自動調整などは行っていません。
スクリーンの左上が (0,0) であるとは限りませんのでご注意ください。
また、現在の状態を保存して次回起動時に使用する場合なども
次もスクリーンの状態が同じとは限りません。
タスクバーの位置や解像度などに変更があると表示がおかしくなる場合があるのでご注意ください。

## 関数一覧

※ 関数形式でのみ呼び出しが可能ですので、()の省略はできません。

```ruby
WLIB::SetGameWindowSize(width, height)
```

ウィンドウのサイズを変更します。処理に失敗した場合は、false を返します。

```ruby
WLIB::MoveGameWindow(x, y)
```

指定座標にウィンドウを移動します。処理に失敗した場合は、false を返します。

```ruby
WLIB::MoveGameWindowCenter()
```

画面中央にウィンドウを移動します。処理に失敗した場合は、false を返します。

```ruby
WLIB::GetDesktopRect()
```

デスクトップの位置とサイズを取得します。処理が成功すると、Rect オブジェクトを返します。失敗した場合は、nil が返ります。

```ruby
WLIB::GetGameWindowRect()
```

ウィンドウの位置とサイズを取得します。処理が成功すると、Rect オブジェクトを返します。失敗した場合は、nil が返ります。

```ruby
WLIB::GetGameClientRect()
```

ウィンドウのクライアント領域のサイズを取得します。処理が成功すると、Rect オブジェクトを返します。プロパティ x と y は、常に 0 です。失敗した場合は、nil が返ります。

```ruby
WLIB::GetFrameSize()
```

ウィンドウのフレームサイズを取得します。処理が成功すると、[タイトルバー, 左右フレーム, 上下フレーム] を返します。
